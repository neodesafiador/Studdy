{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="{% static 'css/subject_styles.css' %}">
    <title>12th Grade Astronomy</title>
</head>

<!----------------------------------------------------------------------------->
<!-- Content Section -->

<body>
    <header>
        <div class="banner">
            <p class="banner-text">Studdy<p>
            <p class="banner-text" style="font-size: 14px; font-weight: normal; left: 40px; top: 59px;">Your Personalized Study Buddy</p>
        </div>

         <div class="logged-in-as">
            Logged in as {{ request.user.username }}
        </div>

        <div>
            <a href="{% url 'studdyApp:logout' %}" class="logout-button">
                <img src="https://cdn1.iconfinder.com/data/icons/heroicons-ui/24/logout-512.png" alt="Logout" class="logout-icon">
                <span class="popup-note">Logout</span>
            </a>
        </div>

        <div class="dropdown">
            <button>Subjects ⛛</button>
            <div class="dropdown-content">
                <a href="{% url 'studdyApp:select_subject_grade' subject_name='anatomy' %}">Anatomy</a>
                <a href="{% url 'studdyApp:select_subject_grade' subject_name='biology' %}">Biology</a>
                <a href="{% url 'studdyApp:select_subject_grade' subject_name='earth_science' %}">Earth Science</a>
                <a href="{% url 'studdyApp:select_subject_grade' subject_name='physical_science' %}">Physical Science</a>
                <a href="{% url 'studdyApp:select_subject_grade' subject_name='astronomy' %}">Astronomy</a>
                <a href="{% url 'studdyApp:select_subject_grade' subject_name='chemistry' %}">Chemistry</a>
                <a href="{% url 'studdyApp:select_subject_grade' subject_name='environmental_science' %}">Environmental Science</a>
                <a href="{% url 'studdyApp:select_subject_grade' subject_name='physics' %}">Physics</a>
            </div>
        </div>
    </header>

    <div>
        <a href="https://studdy.pythonanywhere.com/" class="home-button">⇦ Back to Home</a>
    </div>

<!----------------------------------------------------------------------------->

    <!-- Subject Intro -->
    <div class="intro-section">
        <h1>12th Grade Astronomy - Helpful Resources</h1>
        <h2>Explore the following resources to deepen your understanding.</h2>
    </div>

</body>

<!----------------------------------------------------------------------------->
<!-- Tables -->

<body>

    <!-- Topic 1: The Universe and its Structure -->
    <div class="topic-section">
        <h2 class="topic-title">Topic 1: The Universe and its Structure</h2>
        <table>
            <thead>
                <tr>
                    <th>Resource</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><a href="https://www.khanacademy.org/humanities/big-history-project/big-bang/the-big-bang" target="_blank">The Big Bang Theory</a></td></tr>
                <tr><td><a href="https://science.nasa.gov/universe/galaxies/types/" target="_blank">Galaxies and the Milky Way</a></td></tr>
            </tbody>
        </table>
    </div>

    <!-- Topic 2: Stars and Stellar Evolution -->
    <div class="topic-section">
        <h2 class="topic-title">Topic 2: Stars and Stellar Evolution</h2>
        <table>
            <thead>
                <tr>
                    <th>Resource</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><a href="https://imagine.gsfc.nasa.gov/educators/lifecycles/LC_main3.html" target="_blank">Life Cycle of Stars</a></td></tr>
                <tr><td><a href="https://www.khanacademy.org/science/cosmology-and-astronomy/stellar-life-topic/stellar-life-death-tutorial/v/black-holes" target="_blank">Supernovae and Black Holes</a></td></tr>
            </tbody>
        </table>
    </div>

    <!-- Topic 3: The Solar System and Planetary Science -->
    <div class="topic-section">
        <h2 class="topic-title">Topic 3: The Solar System and Planetary Science</h2>
        <table>
            <thead>
                <tr>
                    <th>Resource</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><a href="https://science.nasa.gov/solar-system/planets/" target="_blank">Planetary Systems and Formation</a></td></tr>
                <tr><td><a href="https://contrib.pbslearningmedia.org/WGBH/npls13/npls13_int_seasons/index.html" target="_blank">Earth’s Position in the Solar System</a></td></tr>
            </tbody>
        </table>
    </div>

    <!-- Topic 4: Observational Astronomy and Space Exploration -->
    <div class="topic-section">
        <h2 class="topic-title">Topic 4: Observational Astronomy and Space Exploration</h2>
        <table>
            <thead>
                <tr>
                    <th>Resource</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><a href="https://www.ck12.org/book/ck-12-earth-science-for-high-school/section/23.1/" target="_blank">Telescopes and Space Observation</a></td></tr>
                <tr><td><a href="https://science.nasa.gov/planetary-science/programs/mars-exploration/science-goals/" target="_blank">Human Space Exploration</a></td></tr>
            </tbody>
        </table>
    </div>

    <br><hr class="separator">

<!----------------------------------------------------------------------------->
<!-- Problems and Feedback -->

    <br><br><div class="problems-section">
        <h1>Astronomy Practice Problems</h1><br>


{% if practice_type == 'flashcards' %}

    <div class="flashcards-container">
        {% for flashcard in problems %}
            <div class="flip-card">
                <div class="flip-card-inner">
                    <div class="flip-card-front">
                        <p>{{ flashcard.question }}</p>
                    </div>
                    <div class="flip-card-back">
                        <p>{{ flashcard.answer }}</p>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

{% elif practice_type == 'multiple-choice questions' %}

        <div class="question-container">
            {% for item in problems %}
                <div class="question-block" id="question{{ forloop.counter }}">
                    <p><strong>Question {{ item.number }}:</strong> {{ item.question }}</p>
                    <ul class="options-list">
                        {% for letter, option in item.options.items %}
                            <li>
                                <button class="option-button" onclick="checkAnswer('{{ item.number }}', '{{ letter }}', this)">
                                    {{ letter }}. {{ option }}
                                </button>
                            </li>
                        {% endfor %}
                    </ul>
                    <p class="feedback" id="feedback{{ item.number }}" style="display: none;"></p>
                </div>
            {% endfor %}
        </div>

        <!-- Include the script for handling user interactions -->
        <script>
            var correctAnswers = {
                {% for item in problems %}
                    '{{ item.number }}': '{{ item.answer }}'{% if not forloop.last %},{% endif %}
                {% endfor %}
            };

            function checkAnswer(questionNumber, selectedOption, buttonElement) {
                var feedbackElement = document.getElementById('feedback' + questionNumber);
                var correctOption = correctAnswers[questionNumber];

                // Disable all buttons in this question block
                var questionBlock = document.getElementById('question' + questionNumber);
                var buttons = questionBlock.getElementsByClassName('option-button');
                for (var i = 0; i < buttons.length; i++) {
                    buttons[i].disabled = true;
                    buttons[i].style.cursor = 'default';
                    if (buttons[i].textContent.trim().startsWith(correctOption + '.')) {
                        buttons[i].style.backgroundColor = '#d4edda'; // Green background for correct option
                    }
                }

                if (selectedOption === correctOption) {
                    feedbackElement.textContent = 'Correct!';
                    feedbackElement.className += ' correct';
                } else {
                    feedbackElement.textContent = 'Incorrect. The correct answer is ' + correctOption + '.';
                    feedbackElement.className += ' incorrect';
                    // Highlight the selected incorrect option
                    buttonElement.style.backgroundColor = '#f8d7da'; // Red background for incorrect option
                }

                feedbackElement.style.display = 'block';
            }
        </script>

{% elif practice_type == 'matching exercises' %}

        <div class="matching-exercises">
            <div>
                <h2>List A:</h2>
                <ul>
                    {% for item in problems.list_a %}
                        <li>{{ item.number }}. {{ item.term }}</li>
                    {% endfor %}
                </ul>
            </div>

            <div>
                <h2>List B:</h2>
                <ul>
                    {% for item in problems.list_b %}
                        <li>{{ item.letter }}. {{ item.definition }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <div class="matching-exercises">
            <div>
                <br><h2>Your Answers:</h2>
                <form id="matchingForm" onsubmit="return false">
                    <ul>
                        {% for item in problems.list_a %}
                            <li>
                                {{ item.number }} -
                                <input type="text" name="answer{{ item.number }}" size="1" maxlength="1" oninput="this.value = this.value.toUpperCase();">
                            </li>
                        {% endfor %}
                    </ul>
                    <button class="button" onclick="checkMatchingAnswers()">Check Answers</button>
                </form>
            </div>

            <div id="matchingFeedback" style="display:none;">
                    <br><h3>Feedback:</h3>
                    <ul id="feedbackList"></ul>
            </div>
        </div>

        <script>
            var correctAnswers = {
                {% for num, letter in problems.answer_key.items %}
                    '{{ num }}': '{{ letter }}'{% if not forloop.last %},{% endif %}
                {% endfor %}
            };

            function checkMatchingAnswers() {
                var feedbackList = document.getElementById('feedbackList');
                feedbackList.innerHTML = '';
                var form = document.getElementById('matchingForm');
                var allCorrect = true;

                {% for item in problems.list_a %}
                    var userAnswer = form['answer{{ item.number }}'].value.trim().toUpperCase();
                    var correctAnswer = correctAnswers['{{ item.number }}'];
                    var feedbackItem = document.createElement('li');
                    if (userAnswer === correctAnswer) {
                        feedbackItem.innerHTML = '{{ item.number }} - Correct!';
                        feedbackItem.className = 'feedback correct';
                    } else {
                        feedbackItem.innerHTML = '{{ item.number }} - Incorrect. Correct answer: ' + correctAnswer;
                        feedbackItem.className = 'feedback incorrect';
                        allCorrect = false;
                    }
                    feedbackList.appendChild(feedbackItem);
                {% endfor %}

                document.getElementById('matchingFeedback').style.display = 'block';
            }
        </script>

{% elif practice_type == 'short answer questions' %}
        {% if graded_results %}
            <!-- Display Graded Results -->
            <div class="graded-results">
                {% for result in graded_results %}
                    <div class="question-block">
                        <br><p><strong>Question {{ result.number }}:</strong> {{ result.question }}</p>
                        <p><strong>Your Answer:</strong> {{ result.user_answer }}</p>
                        <p><strong>Correct Answer:</strong> {{ result.correct_answer }}</p>
                        <p><strong>Score:</strong> {{ result.score }} / 5</p>
                        <p><strong>Feedback:</strong> {{ result.feedback }}</p><br>
                    </div>
                    <hr>
                {% endfor %}
            </div>
        {% else %}
            <!-- Display Questions with Input Fields -->
            <form method="post">
                {% csrf_token %}
                {% for item in problems %}
                    <div class="question-block">
                        <p>&nbsp;</p>
                        <p><strong>Question {{ item.number }}:</strong> {{ item.question }}</p>
                        <textarea name="user_answer_{{ item.number }}" rows="3" cols="80"></textarea>
                    </div>
                    <!-- <hr> -->
                {% endfor %}
                <input type="submit" class="button" name="submit_answers" value="Submit Answers">
            </form>
        {% endif %}
{% else %}
    <pre>{{ problems }}</pre>
{% endif %}

    </div>


<div class="feedback-form">
    <br><h2>Select the Type of Practice Problems:</h2>
    <form method="post">
        {% csrf_token %}
        <label>
            <input type="radio" name="q3_answer" value="A" {% if q3_answer == 'A' %}checked{% endif %}> Multiple Choice Questions
        </label>
        <label>
            <input type="radio" name="q3_answer" value="B" {% if q3_answer == 'B' %}checked{% endif %}> Flashcards
        </label>
        <label>
            <input type="radio" name="q3_answer" value="C" {% if q3_answer == 'C' %}checked{% endif %}> Matching Exercises
        </label>
        <label>
            <input type="radio" name="q3_answer" value="D" {% if q3_answer == 'D' %}checked{% endif %}> Short Answer Questions
        </label><br>

        <label for="feedback">Please provide your feedback:</label>
        <textarea name="feedback">{{ feedback }}</textarea><br>

        <input type="submit" value="Generate Problems">
    </form>
</div>

</body>
</html>
